(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const l=document.querySelector("#app"),o=document.createElement("img");o.src="/player_main.png";o.style.position="absolute";o.style.width="100px";o.style.left="50%";o.style.top="50%";o.style.transform="translate(-50%, -50%)";const f=[];let u=0,h=1,L=2,y,c,d=!1,m=0,p=0;o.addEventListener("mousedown",e=>{d=!0,m=e.clientX-o.offsetLeft,p=e.clientY-o.offsetTop,e.preventDefault()});o.addEventListener("touchstart",e=>{d=!0;const t=e.touches[0];m=t.clientX-o.offsetLeft,p=t.clientY-o.offsetTop,e.preventDefault()});l.addEventListener("mousemove",e=>{if(!d)return;const t=e.clientX-m,n=e.clientY-p;o.style.left=`${t}px`,o.style.top=`${n}px`});l.addEventListener("touchmove",e=>{if(!d)return;const t=e.touches[0],n=t.clientX-m,r=t.clientY-p;o.style.left=`${n}px`,o.style.top=`${r}px`});l.addEventListener("mouseup",()=>{d=!1});l.addEventListener("touchend",()=>{d=!1});function C(){const e=document.createElement("img");e.src="/tekiyaku.png",e.style.position="absolute",e.style.width="120px";const t=Math.random()*(window.innerWidth-120),n=100+Math.random()*(window.innerHeight-220);e.style.left=`${t}px`,e.style.top=`${n}px`,l.appendChild(e),f.push(e)}function w(){const e=o.getBoundingClientRect();f.forEach(t=>{const n=t.getBoundingClientRect(),r=20;e.left+r<n.right-r&&e.right-r>n.left+r&&e.top+r<n.bottom-r&&e.bottom-r>n.top+r&&(u++,console.log(`ヒット数: ${u}`),t.style.left="-1000px",u>=2&&X())})}function X(){f.forEach(t=>t.remove()),clearTimeout(y),c.remove();const e=document.createElement("img");e.src="/covered_sareta.jpg",e.classList.add("game-over-image"),l.appendChild(e)}function Y(){clearTimeout(y),alert("ステージクリア！次のステージへ"),h++,L++,c.querySelector("#stage-number").textContent=h.toString(),c.querySelector("#time-left").textContent="10",f.forEach(e=>e.remove()),f.length=0,E()}function E(){for(;l.firstChild;)l.removeChild(l.firstChild);c=document.createElement("div"),c.classList.add("ui"),c.innerHTML=`
      <div class="stage-text">Stage <span id="stage-number">${h}</span></div>
      <div class="time-text">残り<span id="time-left">10</span>秒</div>
    `,l.appendChild(c),l.appendChild(o),u=0;for(let n=0;n<L;n++)C();let e=10;const t=c.querySelector("#time-left");y=setInterval(()=>{e--,t.textContent=e.toString(),e<=0&&Y()},1e3),x()}function x(){const e=o.offsetLeft,t=o.offsetTop;f.forEach(n=>{const r=n.offsetLeft,s=n.offsetTop,i=e-r,a=t-s,g=Math.sqrt(i*i+a*a),v=2;g>1&&(n.style.left=`${r+i/g*v}px`,n.style.top=`${s+a/g*v}px`)}),w(),requestAnimationFrame(x)}E();
